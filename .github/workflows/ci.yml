# CI Configuration Updates for Test Improvements
# Add these jobs to .github/workflows/ci.yml

# =============================================================================
# NEW JOB: 32-bit Linux Build
# =============================================================================

  linux-32bit:
    name: Linux 32-bit (GCC)
    runs-on: ubuntu-22.04
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Install 32-bit toolchain
        run: |
          sudo apt-get update
          sudo apt-get install -y gcc-multilib g++-multilib
      
      - name: Build and run tests (32-bit)
        run: |
          g++ -std=c++20 -m32 \
            -Wall -Wextra -Wpedantic -Werror \
            -I./include \
            -I./third_party/tf_stub \
            -DTF_WRAPPER_TF_STUB_ENABLED=1 \
            -pthread \
            tests/test_safety.cpp \
            third_party/tf_stub/tf_c_stub.cpp \
            -o test_safety_32
          
          ./test_safety_32

# =============================================================================
# NEW JOB: Safety Invariant Tests
# =============================================================================

  test-safety:
    name: Safety Invariant Tests
    runs-on: ubuntu-24.04
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Build and run safety tests
        run: |
          g++-14 -std=c++20 \
            -Wall -Wextra -Wpedantic -Werror \
            -fsanitize=address,undefined \
            -I./include \
            -I./third_party/tf_stub \
            -DTF_WRAPPER_TF_STUB_ENABLED=1 \
            -pthread \
            tests/test_safety.cpp \
            third_party/tf_stub/tf_c_stub.cpp \
            -o test_safety
          
          ./test_safety

# =============================================================================
# NEW JOB: Stub Dtype Tracking Tests
# =============================================================================

  test-stub-dtype:
    name: Stub Dtype Tracking Tests
    runs-on: ubuntu-24.04
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Build and run dtype tracking tests
        run: |
          g++-14 -std=c++20 \
            -Wall -Wextra -Wpedantic -Werror \
            -I./include \
            -I./third_party/tf_stub \
            -DTF_WRAPPER_TF_STUB_ENABLED=1 \
            -pthread \
            tests/test_stub_dtype_tracking.cpp \
            third_party/tf_stub/tf_c_stub.cpp \
            -o test_stub_dtype
          
          ./test_stub_dtype

# =============================================================================
# NEW JOB: Easy Helpers Tests
# =============================================================================

  test-easy-helpers:
    name: Easy Helpers Tests
    runs-on: ubuntu-24.04
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Build and run helper tests
        run: |
          g++-14 -std=c++20 \
            -Wall -Wextra -Wpedantic -Werror \
            -I./include \
            -I./third_party/tf_stub \
            -DTF_WRAPPER_TF_STUB_ENABLED=1 \
            -pthread \
            tests/test_easy_helpers.cpp \
            third_party/tf_stub/tf_c_stub.cpp \
            -o test_easy_helpers
          
          ./test_easy_helpers

# =============================================================================
# NEW JOB: Bool Tensor Tests
# =============================================================================

  test-bool-tensor:
    name: Bool Tensor Tests
    runs-on: ubuntu-24.04
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Build and run bool tensor tests
        run: |
          g++-14 -std=c++20 \
            -Wall -Wextra -Wpedantic -Werror \
            -fsanitize=address,undefined \
            -I./include \
            -I./third_party/tf_stub \
            -DTF_WRAPPER_TF_STUB_ENABLED=1 \
            -pthread \
            tests/test_bool_tensor.cpp \
            third_party/tf_stub/tf_c_stub.cpp \
            -o test_bool_tensor
          
          ./test_bool_tensor
